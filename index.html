<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Sound Location Selector</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        text-align: center;
      }
      h2 {
        margin: 15px 0;
      }
      #map {
        height: 500px;
        width: 100%;
      }
      #submitBtn {
        margin: 20px;
        padding: 12px 24px;
        font-size: 18px;
        cursor: pointer;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
      }
      #submitBtn:disabled {
        background: #777;
        cursor: not-allowed;
      }
    </style>
  </head>

  <body>

    <h2>Select the location of the sound</h2>

    <div id="map"></div>

    <button id="submitBtn" disabled>Submit Location</button>

    <script>
      // --- FORM SETTINGS ---
      const GOOGLE_FORM_URL =
        "https://docs.google.com/forms/d/e/1FAIpQLScAUZ4jt4pQTiJSG-RuFTworZAeFy_JvJ8rE5MunL3Nf4-Ktg/viewform?usp=pp_url";

      // Latitude + Longitude entry IDs from your form
      const LAT_ID = "entry.1228296879";
      const LNG_ID = "entry.1167906740";

      let chosenLat = null;
      let chosenLng = null;

      // --- MAP ---
      const map = L.map("map").setView([40.014393, -75.313850], 16);

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
      }).addTo(map);

      let marker;

      map.on("click", function (e) {
        chosenLat = e.latlng.lat;
        chosenLng = e.latlng.lng;

        if (marker) map.removeLayer(marker);
        marker = L.marker([chosenLat, chosenLng]).addTo(map);

        document.getElementById("submitBtn").disabled = false;
      });

      // --- SUBMIT BUTTON ---
      document.getElementById("submitBtn").addEventListener("click", function () {
        if (!chosenLat || !chosenLng) return;

        const formURL =
          `${GOOGLE_FORM_URL}&${LAT_ID}=${chosenLat}&${LNG_ID}=${chosenLng}`;

        window.location.href = formURL;
      });
    </script>

  </body>
</html>
